<?xml version="1.0" encoding="utf-8"?>

<mx:Application
    xmlns:mx="http://www.adobe.com/2006/mxml"
    xmlns:ui="org.granite.tide.uibuilder.*"
	xmlns:maps="com.i.eventsmaps.*"
    layout="absolute"
    backgroundColor="#ffffff"
    backgroundAlpha="0"
    preinitialize="preInit();"
	width="660"
	height="660"
	>
	
   	<!-- mate event map
    <mx:Style source="style/style.css"/>
   	<maps:MainEventMap/>
   	-->
    <mx:Style source="xan.css"/>
    
	<mx:Script>
   		<![CDATA[
   			import com.i.PostBase;
   			import mx.binding.utils.BindingUtils;
   			import mx.collections.XMLListCollection;
   			import mx.events.TreeEvent;	   
	        import mx.collections.ArrayCollection;
	        import org.granite.tide.spring.Spring;
	        import org.granite.tide.events.TideResultEvent;
			import mx.events.ListEvent;
			import mx.controls.Alert;
			import org.granite.tide.spring.Context;
			import org.granite.tide.events.TideResultEvent;
			import com.i.Post;
			
			[Bindable]
			private var post:PostBase = new PostBase();
			private var tideContext:Context = Spring.getInstance().getSpringContext();
			[Bindable]
			public var posts:ArrayCollection = new ArrayCollection();
			
			private function preInit():void
			{    	
				Spring.getInstance().initApplication();
				listPosts();
			}
			
			private function listPosts():void 
			{
				tideContext.postService.list(listResult);
			}

			private function listResult(event:TideResultEvent):void
			{ 
				posts = event.result as ArrayCollection;
			}
			
			private function showPost():void
			{
				post = iChingMenu.selectedItem as Post;
				wipeDown.play([postBody]);
			}
		]]>
	</mx:Script>
			
	<mx:Style>

	</mx:Style>		   

	<mx:WipeDown id="wipeDown" duration="2000"/>
	<mx:WipeUp id="wipeUp" duration="300"/>
    <mx:WipeDown id="canvasWipeDown" duration="300"/>

	<mx:VBox backgroundColor="#000000" backgroundAlpha="0.6" label="Cast I Ching" width="100%" height="100%" 
		borderStyle="solid" cornerRadius="6" borderThickness="0">
		<mx:LinkBar color="#0000FF" fontWeight="bold" dataProvider="{myViewStack}"/>		
		<mx:ViewStack id="myViewStack" borderStyle="none" width="100%" height="100%">		
			<mx:Canvas id="castIChing" backgroundAlpha="0" label="Cast IChing" color="#ffffff" width="100%" height="100%">
				<mx:constraintColumns>
					<mx:ConstraintColumn id="navCol"/>
					<mx:ConstraintColumn id="postContentCol"/>
				</mx:constraintColumns>
				<mx:Tree left="navCol:0" itemClick="showPost()" width="200" height="80%" id="iChingMenu" labelField="title" showRoot="false" dataProvider="{posts}" fontSize="12"/>
				<mx:Canvas left="postContentCol:0"
					width="460"
					height="100%" 
					id="iChingContent" 
					backgroundAlpha="0"
					showEffect="{wipeUp}"
					hideEffect="{canvasWipeDown}">
					<mx:Image>
						<mx:source></mx:source>
					</mx:Image>
					<mx:Text id="postBody" color="#ffffff" htmlText="{post.body}" width="430" paddingLeft="10" paddingTop="10" paddingBottom="10" paddingRight="10" fontSize="12"/>
				 </mx:Canvas>
			</mx:Canvas>			
			<mx:Canvas
				id="IChingReferences"
				backgroundAlpha="0"
				label="IChing References"
				width="100%"
				height="100%"
				showEffect="{wipeUp}"
				hideEffect="{canvasWipeDown}">
				<mx:Label text="ICHING" color="#000000"/>
			</mx:Canvas>			
		</mx:ViewStack>		
	</mx:VBox>
        
</mx:Application>
